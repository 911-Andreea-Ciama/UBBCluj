     1                                  
     2                                  bits 32        
     3                                  
     4                                  
     5                                  extern exit, scanf, printf               
     6                                  import exit msvcrt.dll    
     7                                  import scanf msvcrt.dll                       
     8                                  import printf msvcrt.dll
     9                                  
    10                                  global _read
    11                                  
    12                                  segment data public data use32
    13 00000000 256400                      formats db "%d", 0
    14 00000003 00000000                    a dd 0
    15                                      segment code public code use32
    16                                      _read:
    17 00000000 55                                  push ebp
    18 00000001 89E5                                mov ebp, esp   
    19 00000003 60                                  pushad
    20                                          my_loop:
    21                                              
    22 00000004 68[03000000]                        push dword a
    23 00000009 68[00000000]                        push dword formats
    24 0000000E FF15[00000000]                      call [scanf]
    25 00000014 83C408                              add ESP, 4*2
    26                                              
    27 00000017 EBEB                                jmp my_loop
    28 00000019 61                                  popad 
    29 0000001A B8[03000000]                        mov eax, a 
    30 0000001F 89EC                                mov esp, ebp
    31 00000021 5D                                  pop ebp            
    32 00000022 C3                              ret
    33                                          
    34                                         
